function convertToJSON() {
  // sheet 불러올 때, 주석 해제 필요
  // const sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName('230327');
  // let [headers, ...rows] = sheet.getDataRange().getValues();

  const headers = [
    "upperTitle",
    "buttonName",
    "buttonImage",
    "title",
    "contents",
    "contentImage",
    "linkName",
    "link",
    "",
    "upperTitle",
    "buttonName",
    "buttonImage",
    "title",
    "contents",
    "contentImage",
    "linkName",
    "link",
    "",
    "upperTitle",
    "buttonName",
    "buttonImage",
    "title",
    "contents",
    "contentImage",
    "linkName",
    "link",
    "",
    "upperTitle",
    "buttonName",
    "buttonImage",
    "title",
    "contents",
    "contentImage",
    "linkName",
    "link",
  ];

  const rows = [
    [
      "",
      "1",
      "1",
      "1",
      "1",
      "1",
      "1",
      "1",
      "",
      "1",
      "2",
      "2",
      "2",
      "2",
      "2",
      "2",
      "2",
      "",
      "2",
      "3",
      "3",
      "3",
      "3",
      "3",
      "3",
      "3",
      "",
      "3",
      "4",
      "4",
      "4",
      "4",
      "4",
      "4",
      "4",
    ],
    [
      "",
      "\b",
      "",
      "",
      "",
      "",
      "1-1",
      "1-1",
      "",
      "",
      "\b",
      "",
      "",
      "",
      "",
      "2-1",
      "2-1",
      "",
      "",
      "\b",
      "",
      "",
      "",
      "",
      "3-1",
      "3-1",
      "",
      "",
      "\b",
      "",
      "",
      "",
      "",
      "4-1",
      "4-1",
    ],
    [
      "",
      "",
      "",
      "",
      "",
      "",
      "1-2",
      "1-2",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
    ],
    [
      "",
      "5",
      "5",
      "5",
      "5",
      "5",
      "5",
      "5",
      "",
      "5",
      "6",
      "6",
      "6",
      "6",
      "6",
      "6",
      "6",
      "",
      "6",
      "7",
      "7",
      "7",
      "7",
      "7",
      "7",
      "7",
      "",
      "7",
      "8",
      "8",
      "8",
      "8",
      "8",
      "8",
      "8",
    ],
    [
      "",
      "\b",
      "",
      "",
      "",
      "",
      "5-1",
      "5-1",
      "",
      "",
      "\b",
      "",
      "",
      "",
      "",
      "6-1",
      "6-1",
      "",
      "",
      "\b",
      "",
      "",
      "",
      "",
      "7-1",
      "7-1",
      "",
      "",
      "\b",
      "",
      "",
      "",
      "",
      "8-1",
      "8-1",
    ],
    [
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "5",
      "9",
      "9",
      "9",
      "9",
      "9",
      "9",
      "9",
      "",
      "9",
      "10",
      "10",
      "10",
      "10",
      "10",
      "10",
      "10",
      "",
      "10",
      "11",
      "11",
      "11",
      "11",
      "11",
      "11",
      "11",
    ],
    [
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "10-1",
      "10-1",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
    ],
    [
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "10-2",
      "10-2",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
    ],
    [
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "10-3",
      "10-3",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
    ],
    [
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      5,
      "12",
      "12",
      "12",
      "12",
      "12",
      "12",
      "12",
      "",
      "12",
      "13",
      "13",
      "13",
      "13",
      "13",
      "13",
      "13",
      "",
      "13",
      "14",
      "14",
      "14",
      "14",
      "14",
      "14",
      "14",
    ],
    [
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "\b",
      "",
      "",
      "",
      "",
      "12-1",
      "12-1",
      "",
      "",
      "\b",
      "",
      "",
      "",
      "",
      "13-1",
      "13-1",
      "",
      "",
      "\b",
      "",
      "",
      "",
      "",
      "14-1",
      "14-1",
    ],
    [
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "12",
      "15",
      "15",
      "15",
      "15",
      "15",
      "15",
      "15",
      "",
      "15",
      "16",
      "16",
      "16",
      "16",
      "16",
      "16",
      "16",
    ],
    [
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "\b",
      "",
      "",
      "",
      "",
      "15-1",
      "15-1",
      "",
      "",
      "\b",
      "",
      "",
      "",
      "",
      "16-1",
      "16-1",
    ],
    [
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "15",
      "17",
      "17",
      "17",
      "17",
      "17",
      "17",
      "17",
    ],
    [
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "\b",
      "",
      "",
      "",
      "",
      "1777",
      "1777",
    ],
    [
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "15",
      "18",
      "18",
      "18",
      "18",
      "18",
      "18",
      "18",
    ],
    [
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "\b",
      "",
      "",
      "",
      "",
      "1188",
      "1888",
    ],
    [
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "15",
      "19",
      "19",
      "19",
      "19",
      "19",
      "19",
      "19",
    ],
    [
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "\b",
      "",
      "",
      "",
      "",
      "199",
      "16-1",
    ],
  ];

  let result = [];

  // depth 설정
  const PROPERTY_LENGTH = 8;

  // 행기준으로 묶으면서 옵션들은 해당 데이터에 종속시킴
  for (let i = 0; i < rows.length; i++) {
    let tmp = {};
    for (let j = 0; j < rows[i].length; j++) {
      if (headers[j].includes("link")) {
        if (tmp.title) {
          tmp[headers[j]] = rows[i][j] !== "\b" ? [rows[i][j]] : [];
          const options = [];
          // 링크 관련 데이터들 아래로 들어가면서 추가하기
          for (let k = i + 1; k < rows.length; k++) {
            // 해당 줄의 타이틀 혹은 콘텐츠가 없으면 상위에 종속되는 행임
            if (rows[k][j - 3].length === 0 && rows[k][j]) {
              options.push(rows[k][j]);
            } else {
              // 새로운 행 만나면 멈춰
              break;
            }
          }
          tmp[headers[j]].push(...options);
        }
      } else if (headers[j]) {
        tmp[headers[j]] = rows[i][j] !== "\b" ? rows[i][j] : "";
      }

      if (Object.keys(tmp).length === PROPERTY_LENGTH && tmp.title) {
        result.push(tmp);
        tmp = {};
      }
    }
  }

  // links로 묶기
  let linkId = 0;
  for (let i = 0; i < result.length; i++) {
    const linkNames = result[i].linkName;
    const links = result[i].link;
    if (linkNames[0]) {
      const linkArray = linkNames.map((name, index) => ({
        linkId: `l${linkId++}`,
        link: links[index],
        linkName: name,
      }));
      result[i].links = linkArray;
    } else {
      result[i].links = [];
    }

    delete result[i].linkName;
    delete result[i].link;
  }

  // index 적용
  const obj = {};

  result.forEach((item, index) => {
    obj[index] = item;
  });

  // 부모 & 자식 관계 설정
  for (const [key, value] of Object.entries(obj)) {
    const selection = "selection";
    value[selection] = [];

    for (const [childKey, childValue] of Object.entries(obj)) {
      if (childValue.upperTitle === value.title) {
        value[selection].push(childKey);
        const parent = "parent";
        childValue[parent] = key;
      }
    }
  }

  // json으로 변환하여 파일로 export
  let jsonString = JSON.stringify(obj);
  let folder = DriveApp.getRootFolder();
  let file = folder.createFile(
    "inisfree.json",
    jsonString,
    MimeType.PLAIN_TEXT
  );
}

convertToJSON();
